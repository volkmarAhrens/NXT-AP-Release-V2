/*!
 * OpenUI5
 * (c) Copyright 2009-2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/documentation/sdk/controller/BaseController","sap/ui/model/json/JSONModel","sap/ui/documentation/library","sap/base/util/Version","sap/base/Log","sap/ui/documentation/sdk/util/Resources"],function(jQuery,e,s,o,i,t,n){"use strict";var r=n.getResourceOriginPath("neo-app.json"),a=n.getResourceOriginPath("resources/sap-ui-version.json");return e.extend("sap.ui.documentation.sdk.controller.ReleaseNotes",{onInit:function(){this._oView=this.getView();this._requestResources();this._resourceAvailabilityHandler();this._oModel=new s;this._oVersionModel=new s;this._oView.setModel(this._oModel);this._oView.setModel(this._oVersionModel,"select");o._getAppInfo(this._processAppInfo.bind(this))},_processAppInfo:function(e){var s,o,t,n,r;if(!e){return}s=i(e.version);o=s.getMajor();t=s.getMinor();if(s.getSuffix()!==""){if(t%2!==0){t=t+1}}n=o+"."+t;this._updateVersionInformation(n);r={items:[]};while(t>=28){n=o+"."+t;r.items.push({key:n,value:n});t=t-(t<=60?2:1)}this._oVersionModel.setData(r);this.appendPageTitle(this.getModel("i18n").getProperty("RELEASE_NOTES_TITLE"))},_processLibInfo:function(e,s){var o,t=[],n=e.length,r,a;r=function(s,t){o+=t.notes.length;e[a].versions.push({version:s,notes:t.notes});e[a].versions.sort(function(e,s){return i(s.version).compareTo(e.version)})};for(a=0;a<n;a++){e[a]=s[e[a]];e[a].versions=[];if(e[a].relnotes){o=0;jQuery.each(e[a].relnotes,r);if(o>0){t.push(e[a])}}}this._oModel.setData({libs:t});this._hideBusyIndicator()},_requestResources:function(){this._oNeoAppJsonPromise=jQuery.ajax(r);this._oSapUiVersionJsonPromise=jQuery.ajax(a)},_resourceAvailabilityHandler:function(){jQuery.when(this._oNeoAppJsonPromise,this._oSapUiVersionJsonPromise).then(function(e,s){this._oNeoAppVersions=e[0].routes;this._sSapUiVersion=s[0].version;this._oView.byId("VersionSelect").setVisible(true)}.bind(this),function(){t.warning("No neo-app.json was detected")})},_compareUI5Versions:function(e,s){var o=i(e),t=i(s);return o.getMajor()+"."+o.getMinor()===t.getMajor()+"."+t.getMinor()},_updateLastReleasedVersion:function(e){if(this._compareUI5Versions(e,this._sSapUiVersion)&&parseFloat(this._sLastReleasedVersion)>parseFloat(this._sSapUiVersion)){this._sLastReleasedVersion=this._sSapUiVersion}},_getLastVersionFromNeoAppJson:function(e){var s=this._oNeoAppVersions?this._oNeoAppVersions.length:0,o,i;for(i=0;i<s;i++){o=this._oNeoAppVersions[i].target.version;if(this._compareUI5Versions(o,e)){return o}}},handleVersionChange:function(e){var s=e.getParameter("selectedItem"),o=s.getKey();this._updateVersionInformation(o)},_updateVersionInformation:function(e){var s;this._sLastReleasedVersion=this._getLastVersionFromNeoAppJson(e);this._updateLastReleasedVersion(e);s=this._sLastReleasedVersion?this._sLastReleasedVersion:e;this._showBusyIndicator();o._loadAllLibInfo("","_getLibraryInfoAndReleaseNotes",s,this._processLibInfo.bind(this))},_showBusyIndicator:function(){this.byId("releaseNotesObjectPage").setBusy(true)},_hideBusyIndicator:function(){this.byId("releaseNotesObjectPage").setBusy(false)}})});
//# sourceMappingURL=ReleaseNotes.controller.js.map