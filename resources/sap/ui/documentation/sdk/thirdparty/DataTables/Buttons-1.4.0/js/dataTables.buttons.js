/*! Buttons for DataTables 1.4.0
 * Â©2016 SpryMedia Ltd - datatables.net/license
 */
(function(t){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(n){return t(n,window,document)})}else if(typeof exports==="object"){module.exports=function(n,e){if(!n){n=window}if(!e||!e.fn.dataTable){e=require("datatables.net")(n,e).$}return t(e,n,n.document)}}else{t(jQuery,window,document)}})(function(t,n,e,o){"use strict";var i=t.fn.dataTable;var r=0;var a=0;var s=i.ext.buttons;var u=function(n,e){if(typeof e==="undefined"){e={}}if(e===true){e={}}if(t.isArray(e)){e={buttons:e}}this.c=t.extend(true,{},u.defaults,e);if(e.buttons){this.c.buttons=e.buttons}this.s={dt:new i.Api(n),buttons:[],listenKeys:"",namespace:"dtb"+r++};this.dom={container:t("<"+this.c.dom.container.tag+"/>").addClass(this.c.dom.container.className)};this._constructor()};t.extend(u.prototype,{action:function(t,n){var e=this._nodeToButton(t);if(n===o){return e.conf.action}e.conf.action=n;return this},active:function(n,e){var i=this._nodeToButton(n);var r=this.c.dom.button.active;var a=t(i.node);if(e===o){return a.hasClass(r)}a.toggleClass(r,e===o?true:e);return this},add:function(t,n){var e=this.s.buttons;if(typeof n==="string"){var o=n.split("-");var i=this.s;for(var r=0,a=o.length-1;r<a;r++){i=i.buttons[o[r]*1]}e=i.buttons;n=o[o.length-1]*1}this._expandButton(e,t,false,n);this._draw();return this},container:function(){return this.dom.container},disable:function(n){var e=this._nodeToButton(n);t(e.node).addClass(this.c.dom.button.disabled);return this},destroy:function(){t("body").off("keyup."+this.s.namespace);var n=this.s.buttons.slice();var e,o;for(e=0,o=n.length;e<o;e++){this.remove(n[e].node)}this.dom.container.remove();var i=this.s.dt.settings()[0];for(e=0,o=i.length;e<o;e++){if(i.inst===this){i.splice(e,1);break}}return this},enable:function(n,e){if(e===false){return this.disable(n)}var o=this._nodeToButton(n);t(o.node).removeClass(this.c.dom.button.disabled);return this},name:function(){return this.c.name},node:function(n){var e=this._nodeToButton(n);return t(e.node)},processing:function(n,e){var i=this._nodeToButton(n);if(e===o){return t(i.node).hasClass("processing")}t(i.node).toggleClass("processing",e);return this},remove:function(n){var e=this._nodeToButton(n);var o=this._nodeToHost(n);var i=this.s.dt;if(e.buttons.length){for(var r=e.buttons.length-1;r>=0;r--){this.remove(e.buttons[r].node)}}if(e.conf.destroy){e.conf.destroy.call(i.button(n),i,t(n),e.conf)}this._removeKey(e.conf);t(e.node).remove();var a=t.inArray(e,o);o.splice(a,1);return this},text:function(n,e){var i=this._nodeToButton(n);var r=this.c.dom.collection.buttonLiner;var a=i.inCollection&&r&&r.tag?r.tag:this.c.dom.buttonLiner.tag;var s=this.s.dt;var u=t(i.node);var l=function(t){return typeof t==="function"?t(s,u,i.conf):t};if(e===o){return l(i.conf.text)}i.conf.text=e;if(a){u.children(a).html(l(e))}else{u.html(l(e))}return this},_constructor:function(){var n=this;var o=this.s.dt;var i=o.settings()[0];var r=this.c.buttons;if(!i._buttons){i._buttons=[]}i._buttons.push({inst:this,name:this.c.name});for(var a=0,s=r.length;a<s;a++){this.add(r[a])}o.on("destroy",function(){n.destroy()});t("body").on("keyup."+this.s.namespace,function(t){if(!e.activeElement||e.activeElement===e.body){var o=String.fromCharCode(t.keyCode).toLowerCase();if(n.s.listenKeys.toLowerCase().indexOf(o)!==-1){n._keypress(o,t)}}})},_addKey:function(n){if(n.key){this.s.listenKeys+=t.isPlainObject(n.key)?n.key.key:n.key}},_draw:function(t,n){if(!t){t=this.dom.container;n=this.s.buttons}t.children().detach();for(var e=0,o=n.length;e<o;e++){t.append(n[e].inserter);if(n[e].buttons&&n[e].buttons.length){this._draw(n[e].collection,n[e].buttons)}}},_expandButton:function(n,e,i,r){var a=this.s.dt;var s=0;var u=!t.isArray(e)?[e]:e;for(var l=0,c=u.length;l<c;l++){var f=this._resolveExtends(u[l]);if(!f){continue}if(t.isArray(f)){this._expandButton(n,f,i,r);continue}var d=this._buildButton(f,i);if(!d){continue}if(r!==o){n.splice(r,0,d);r++}else{n.push(d)}if(d.conf.buttons){var h=this.c.dom.collection;d.collection=t("<"+h.tag+"/>").addClass(h.className).attr("role","menu");d.conf._collection=d.collection;this._expandButton(d.buttons,d.conf.buttons,true,r)}if(f.init){f.init.call(a.button(d.node),a,t(d.node),f)}s++}},_buildButton:function(n,e){var o=this.c.dom.button;var i=this.c.dom.buttonLiner;var r=this.c.dom.collection;var s=this.s.dt;var u=function(t){return typeof t==="function"?t(s,c,n):t};if(e&&r.button){o=r.button}if(e&&r.buttonLiner){i=r.buttonLiner}if(n.available&&!n.available(s,n)){return false}var l=function(n,e,o,i){i.action.call(e.button(o),n,e,o,i);t(e.table().node()).triggerHandler("buttons-action.dt",[e.button(o),e,o,i])};var c=t("<"+o.tag+"/>").addClass(o.className).attr("tabindex",this.s.dt.settings()[0].iTabIndex).attr("aria-controls",this.s.dt.table().node().id).on("click.dtb",function(t){t.preventDefault();if(!c.hasClass(o.disabled)&&n.action){l(t,s,c,n)}c.blur()}).on("keyup.dtb",function(t){if(t.keyCode===13){if(!c.hasClass(o.disabled)&&n.action){l(t,s,c,n)}}});if(o.tag.toLowerCase()==="a"){c.attr("href","#")}if(i.tag){var f=t("<"+i.tag+"/>").html(u(n.text)).addClass(i.className);if(i.tag.toLowerCase()==="a"){f.attr("href","#")}c.append(f)}else{c.html(u(n.text))}if(n.enabled===false){c.addClass(o.disabled)}if(n.className){c.addClass(n.className)}if(n.titleAttr){c.attr("title",u(n.titleAttr))}if(!n.namespace){n.namespace=".dt-button-"+a++}var d=this.c.dom.buttonContainer;var h;if(d&&d.tag){h=t("<"+d.tag+"/>").addClass(d.className).append(c)}else{h=c}this._addKey(n);return{conf:n,node:c.get(0),inserter:h,buttons:[],inCollection:e,collection:null}},_nodeToButton:function(t,n){if(!n){n=this.s.buttons}for(var e=0,o=n.length;e<o;e++){if(n[e].node===t){return n[e]}if(n[e].buttons.length){var i=this._nodeToButton(t,n[e].buttons);if(i){return i}}}},_nodeToHost:function(t,n){if(!n){n=this.s.buttons}for(var e=0,o=n.length;e<o;e++){if(n[e].node===t){return n}if(n[e].buttons.length){var i=this._nodeToHost(t,n[e].buttons);if(i){return i}}}},_keypress:function(n,e){var o=function(o,i){if(!o.key){return}if(o.key===n){t(i).click()}else if(t.isPlainObject(o.key)){if(o.key.key!==n){return}if(o.key.shiftKey&&!e.shiftKey){return}if(o.key.altKey&&!e.altKey){return}if(o.key.ctrlKey&&!e.ctrlKey){return}if(o.key.metaKey&&!e.metaKey){return}t(i).click()}};var i=function(t){for(var n=0,e=t.length;n<e;n++){o(t[n].conf,t[n].node);if(t[n].buttons.length){i(t[n].buttons)}}};i(this.s.buttons)},_removeKey:function(n){if(n.key){var e=t.isPlainObject(n.key)?n.key.key:n.key;var o=this.s.listenKeys.split("");var i=t.inArray(e,o);o.splice(i,1);this.s.listenKeys=o.join("")}},_resolveExtends:function(n){var e=this.s.dt;var i,r;var a=function(i){var r=0;while(!t.isPlainObject(i)&&!t.isArray(i)){if(i===o){return}if(typeof i==="function"){i=i(e,n);if(!i){return false}}else if(typeof i==="string"){if(!s[i]){throw"Unknown button type: "+i}i=s[i]}r++;if(r>30){throw"Buttons: Too many iterations"}}return t.isArray(i)?i:t.extend({},i)};n=a(n);while(n&&n.extend){if(!s[n.extend]){throw"Cannot extend unknown button type: "+n.extend}var u=a(s[n.extend]);if(t.isArray(u)){return u}else if(!u){return false}var l=u.className;n=t.extend({},u,n);if(l&&n.className!==l){n.className=l+" "+n.className}var c=n.postfixButtons;if(c){if(!n.buttons){n.buttons=[]}for(i=0,r=c.length;i<r;i++){n.buttons.push(c[i])}n.postfixButtons=null}var f=n.prefixButtons;if(f){if(!n.buttons){n.buttons=[]}for(i=0,r=f.length;i<r;i++){n.buttons.splice(i,0,f[i])}n.prefixButtons=null}n.extend=u.extend}return n}});u.background=function(n,e,i){if(i===o){i=400}if(n){t("<div/>").addClass(e).css("display","none").appendTo("body").fadeIn(i)}else{t("body > div."+e).fadeOut(i,function(){t(this).removeClass(e).remove()})}};u.instanceSelector=function(n,e){if(!n){return t.map(e,function(t){return t.inst})}var o=[];var i=t.map(e,function(t){return t.name});var r=function(n){if(t.isArray(n)){for(var a=0,s=n.length;a<s;a++){r(n[a])}return}if(typeof n==="string"){if(n.indexOf(",")!==-1){r(n.split(","))}else{var u=t.inArray(t.trim(n),i);if(u!==-1){o.push(e[u].inst)}}}else if(typeof n==="number"){o.push(e[n].inst)}};r(n);return o};u.buttonSelector=function(n,e){var i=[];var r=function(t,n,e){var i;var a;for(var s=0,u=n.length;s<u;s++){i=n[s];if(i){a=e!==o?e+s:s+"";t.push({node:i.node,name:i.conf.name,idx:a});if(i.buttons){r(t,i.buttons,a+"-")}}}};var a=function(n,e){var s,u;var l=[];r(l,e.s.buttons);var c=t.map(l,function(t){return t.node});if(t.isArray(n)||n instanceof t){for(s=0,u=n.length;s<u;s++){a(n[s],e)}return}if(n===null||n===o||n==="*"){for(s=0,u=l.length;s<u;s++){i.push({inst:e,node:l[s].node})}}else if(typeof n==="number"){i.push({inst:e,node:e.s.buttons[n].node})}else if(typeof n==="string"){if(n.indexOf(",")!==-1){var f=n.split(",");for(s=0,u=f.length;s<u;s++){a(t.trim(f[s]),e)}}else if(n.match(/^\d+(\-\d+)*$/)){var d=t.map(l,function(t){return t.idx});i.push({inst:e,node:l[t.inArray(n,d)].node})}else if(n.indexOf(":name")!==-1){var h=n.replace(":name","");for(s=0,u=l.length;s<u;s++){if(l[s].name===h){i.push({inst:e,node:l[s].node})}}}else{t(c).filter(n).each(function(){i.push({inst:e,node:this})})}}else if(typeof n==="object"&&n.nodeName){var b=t.inArray(n,c);if(b!==-1){i.push({inst:e,node:c[b]})}}};for(var s=0,u=n.length;s<u;s++){var l=n[s];a(e,l)}return i};u.defaults={buttons:["copy","excel","csv","pdf","print"],name:"main",tabIndex:0,dom:{container:{tag:"div",className:"dt-buttons"},collection:{tag:"div",className:"dt-button-collection"},button:{tag:"a",className:"dt-button",active:"active",disabled:"disabled"},buttonLiner:{tag:"span",className:""}}};u.version="1.4.0";t.extend(s,{collection:{text:function(t){return t.i18n("buttons.collection","Collection")},className:"buttons-collection",action:function(e,o,i,r){var a=i;var s=a.offset();var l=t(o.table().container());var c=false;if(t("div.dt-button-background").length){c=t(".dt-button-collection").offset();t("body").trigger("click.dtb-collection")}r._collection.addClass(r.collectionLayout).css("display","none").appendTo("body").fadeIn(r.fade);var f=r._collection.css("position");if(c&&f==="absolute"){r._collection.css({top:c.top,left:c.left})}else if(f==="absolute"){r._collection.css({top:s.top+a.outerHeight(),left:s.left});var d=l.offset().top+l.height();var h=s.top+a.outerHeight()+r._collection.outerHeight();var b=h-d;var v=s.top-r._collection.outerHeight();var p=l.offset().top;var g=p-v;if(b>g){r._collection.css("top",s.top-r._collection.outerHeight()-5)}var m=s.left+r._collection.outerWidth();var y=l.offset().left+l.width();if(m>y){r._collection.css("left",s.left-(m-y))}}else{var x=r._collection.height()/2;if(x>t(n).height()/2){x=t(n).height()/2}r._collection.css("marginTop",x*-1)}if(r.background){u.background(true,r.backgroundClassName,r.fade)}setTimeout(function(){t("div.dt-button-background").on("click.dtb-collection",function(){});t("body").on("click.dtb-collection",function(n){var e=t.fn.addBack?"addBack":"andSelf";if(!t(n.target).parents()[e]().filter(r._collection).length){r._collection.fadeOut(r.fade,function(){r._collection.detach()});t("div.dt-button-background").off("click.dtb-collection");u.background(false,r.backgroundClassName,r.fade);t("body").off("click.dtb-collection");o.off("buttons-action.b-internal")}})},10);if(r.autoClose){o.on("buttons-action.b-internal",function(){t("div.dt-button-background").click()})}},background:true,collectionLayout:"",backgroundClassName:"dt-button-background",autoClose:false,fade:400},copy:function(t,n){if(s.copyHtml5){return"copyHtml5"}if(s.copyFlash&&s.copyFlash.available(t,n)){return"copyFlash"}},csv:function(t,n){if(s.csvHtml5&&s.csvHtml5.available(t,n)){return"csvHtml5"}if(s.csvFlash&&s.csvFlash.available(t,n)){return"csvFlash"}},excel:function(t,n){if(s.excelHtml5&&s.excelHtml5.available(t,n)){return"excelHtml5"}if(s.excelFlash&&s.excelFlash.available(t,n)){return"excelFlash"}},pdf:function(t,n){if(s.pdfHtml5&&s.pdfHtml5.available(t,n)){return"pdfHtml5"}if(s.pdfFlash&&s.pdfFlash.available(t,n)){return"pdfFlash"}},pageLength:function(n){var e=n.settings()[0].aLengthMenu;var o=t.isArray(e[0])?e[0]:e;var i=t.isArray(e[0])?e[1]:e;var r=function(t){return t.i18n("buttons.pageLength",{"-1":"Show all rows",_:"Show %d rows"},t.page.len())};return{extend:"collection",text:r,className:"buttons-page-length",autoClose:true,buttons:t.map(o,function(t,n){return{text:i[n],className:"button-page-length",action:function(n,e){e.page.len(t).draw()},init:function(n,e,o){var i=this;var r=function(){i.active(n.page.len()===t)};n.on("length.dt"+o.namespace,r);r()},destroy:function(t,n,e){t.off("length.dt"+e.namespace)}}}),init:function(t,n,e){var o=this;t.on("length.dt"+e.namespace,function(){o.text(r(t))})},destroy:function(t,n,e){t.off("length.dt"+e.namespace)}}}});i.Api.register("buttons()",function(t,n){if(n===o){n=t;t=o}this.selector.buttonGroup=t;var e=this.iterator(true,"table",function(e){if(e._buttons){return u.buttonSelector(u.instanceSelector(t,e._buttons),n)}},true);e._groupSelector=t;return e});i.Api.register("button()",function(t,n){var e=this.buttons(t,n);if(e.length>1){e.splice(1,e.length)}return e});i.Api.registerPlural("buttons().active()","button().active()",function(t){if(t===o){return this.map(function(t){return t.inst.active(t.node)})}return this.each(function(n){n.inst.active(n.node,t)})});i.Api.registerPlural("buttons().action()","button().action()",function(t){if(t===o){return this.map(function(t){return t.inst.action(t.node)})}return this.each(function(n){n.inst.action(n.node,t)})});i.Api.register(["buttons().enable()","button().enable()"],function(t){return this.each(function(n){n.inst.enable(n.node,t)})});i.Api.register(["buttons().disable()","button().disable()"],function(){return this.each(function(t){t.inst.disable(t.node)})});i.Api.registerPlural("buttons().nodes()","button().node()",function(){var n=t();t(this.each(function(t){n=n.add(t.inst.node(t.node))}));return n});i.Api.registerPlural("buttons().processing()","button().processing()",function(t){if(t===o){return this.map(function(t){return t.inst.processing(t.node)})}return this.each(function(n){n.inst.processing(n.node,t)})});i.Api.registerPlural("buttons().text()","button().text()",function(t){if(t===o){return this.map(function(t){return t.inst.text(t.node)})}return this.each(function(n){n.inst.text(n.node,t)})});i.Api.registerPlural("buttons().trigger()","button().trigger()",function(){return this.each(function(t){t.inst.node(t.node).trigger("click")})});i.Api.registerPlural("buttons().containers()","buttons().container()",function(){var n=t();var e=this._groupSelector;this.iterator(true,"table",function(t){if(t._buttons){var o=u.instanceSelector(e,t._buttons);for(var i=0,r=o.length;i<r;i++){n=n.add(o[i].container())}}});return n});i.Api.register("button().add()",function(t,n){var e=this.context;if(e.length){var o=u.instanceSelector(this._groupSelector,e[0]._buttons);if(o.length){o[0].add(n,t)}}return this.button(this._groupSelector,t)});i.Api.register("buttons().destroy()",function(){this.pluck("inst").unique().each(function(t){t.destroy()});return this});i.Api.registerPlural("buttons().remove()","buttons().remove()",function(){this.each(function(t){t.inst.remove(t.node)});return this});var l;i.Api.register("buttons.info()",function(n,e,i){var r=this;if(n===false){t("#datatables_buttons_info").fadeOut(function(){t(this).remove()});clearTimeout(l);l=null;return this}if(l){clearTimeout(l)}if(t("#datatables_buttons_info").length){t("#datatables_buttons_info").remove()}n=n?"<h2>"+n+"</h2>":"";t('<div id="datatables_buttons_info" class="dt-button-info"/>').html(n).append(t("<div/>")[typeof e==="string"?"html":"append"](e)).css("display","none").appendTo("body").fadeIn();if(i!==o&&i!==0){l=setTimeout(function(){r.buttons.info(false)},i)}return this});i.Api.register("buttons.exportData()",function(t){if(this.context.length){return v(new i.Api(this.context[0]),t)}});i.Api.register("buttons.exportInfo()",function(t){if(!t){t={}}return{filename:c(t),title:d(t),messageTop:h(this,t.messageTop||t.message,"top"),messageBottom:h(this,t.messageBottom,"bottom")}});var c=function(n){var e=n.filename==="*"&&n.title!=="*"&&n.title!==o?n.title:n.filename;if(typeof e==="function"){e=e()}if(e===o||e===null){return null}if(e.indexOf("*")!==-1){e=t.trim(e.replace("*",t("title").text()))}e=e.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,"");var i=f(n.extension);if(!i){i=""}return e+i};var f=function(t){if(t===null||t===o){return null}else if(typeof t==="function"){return t()}return t};var d=function(n){var e=f(n.title);return e===null?null:e.indexOf("*")!==-1?e.replace("*",t("title").text()||"Exported data"):e};var h=function(n,e,o){var i=f(e);if(i===null){return null}var r=t("caption",n.table().container()).eq(0);if(i==="*"){var a=r.css("caption-side");if(a!==o){return null}return r.length?r.text():""}return i};var b=t("<textarea/>")[0];var v=function(n,e){var o=t.extend(true,{},{rows:null,columns:"",modifier:{search:"applied",order:"applied"},orthogonal:"display",stripHtml:true,stripNewlines:true,decodeEntities:true,trim:true,format:{header:function(t){return i(t)},footer:function(t){return i(t)},body:function(t){return i(t)}}},e);var i=function(t){if(typeof t!=="string"){return t}t=t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");if(o.stripHtml){t=t.replace(/<[^>]*>/g,"")}if(o.trim){t=t.replace(/^\s+|\s+$/g,"")}if(o.stripNewlines){t=t.replace(/\n/g," ")}if(o.decodeEntities){b.innerHTML=t;t=b.value}return t};var r=n.columns(o.columns).indexes().map(function(t){var e=n.column(t).header();return o.format.header(e.innerHTML,t,e)}).toArray();var a=n.table().footer()?n.columns(o.columns).indexes().map(function(t){var e=n.column(t).footer();return o.format.footer(e?e.innerHTML:"",t,e)}).toArray():null;var s=n.rows(o.rows,o.modifier).indexes().toArray();var u=n.cells(s,o.columns);var l=u.render(o.orthogonal).toArray();var c=u.nodes().toArray();var f=r.length;var d=f>0?l.length/f:0;var h=new Array(d);var v=0;for(var p=0,g=d;p<g;p++){var m=new Array(f);for(var y=0;y<f;y++){m[y]=o.format.body(l[v],p,y,c[v]);v++}h[p]=m}return{header:r,footer:a,body:h}};t.fn.dataTable.Buttons=u;t.fn.DataTable.Buttons=u;t(e).on("init.dt plugin-init.dt",function(t,n){if(t.namespace!=="dt"){return}var e=n.oInit.buttons||i.defaults.buttons;if(e&&!n._buttons){new u(n,e).container()}});i.ext.feature.push({fnInit:function(t){var n=new i.Api(t);var e=n.init().buttons||i.defaults.buttons;return new u(n,e).container()},cFeature:"B"});return u});
//# sourceMappingURL=dataTables.buttons.js.map