/*!
 * OpenUI5
 * (c) Copyright 2009-2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Element","sap/ui/dt/Util","sap/ui/dt/OverlayRegistry","sap/ui/fl/Utils","sap/ui/fl/apply/api/FlexRuntimeInfoAPI","sap/ui/fl/write/api/ChangesWriteAPI","sap/ui/fl/write/api/PersistenceWriteAPI","sap/ui/thirdparty/jquery"],function(e,r,t,a,o,n,i,jQuery){"use strict";return function(s){function l(e){return new Promise(function(r,t){var a;jQuery.ajax({url:a=`${sap.ui.require.toUrl(e)}.js`,async:true,success(e){r(e)},error(r,o,n){var i=new Error(`resource ${e} could not be loaded from ${a}. Check for 'file not found' or parse errors. Reason: ${n}`);i.status=o;i.error=n;i.statusCode=r.status;t(n)},dataType:"text"})})}return{exports:{add(t,l){var c=s.getFlexSettings();if(!c.developerMode){throw r.createError("service.ControllerExtension#add","code extensions can only be created in developer mode","sap.ui.rta")}if(!t){throw r.createError("service.ControllerExtension#add","can't create controller extension without codeRef","sap.ui.rta")}if(!t.endsWith(".js")){throw r.createError("service.ControllerExtension#add","codeRef has to end with 'js'")}var u=e.getElementById(l);var d=a.getAppComponentForControl(u);var p=u.getControllerName&&u.getControllerName()||u.getController()&&u.getController().getMetadata().getName();var g=o.getFlexReference({element:d});var f=g.replace(/\.Component/g,"").replace(/\./g,"/");f+="/changes/";f+=t.replace(/\.js/g,"");var v={codeRef:t,controllerName:p,changeType:"codeExt",layer:c.layer,namespace:c.namespace,reference:g,moduleName:f,generator:"rta.service.ControllerExtension"};var m=n.create({changeSpecificData:v,selector:d});i.add({change:m,selector:d});return m.convertToFileContent()},getTemplate(e){var a=t.getOverlay(e);if(!a){throw r.createError("service.ControllerExtension#getTemplate","no overlay found for the given view ID","sap.ui.rta")}var o=a.getDesignTimeMetadata().getControllerExtensionTemplate();return l(`${o}-dbg`).catch(function(){return l(o)})}}}}});
//# sourceMappingURL=ControllerExtension.js.map