/*!
 * OpenUI5
 * (c) Copyright 2009-2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Lib","sap/ui/rta/plugin/additionalElements/AdditionalElementsPlugin","sap/ui/dt/OverlayRegistry","sap/m/Button"],function(e,t,a,s){"use strict";var i=t.extend("sap.ui.rta.plugin.EasyAdd",{metadata:{library:"sap.ui.rta",properties:{},associations:{},events:{}}});i.prototype.registerElementOverlay=function(...e){const[s]=e;var i=s.getElement();if(i.getMetadata().getName()==="sap.uxap.ObjectPageSection"&&this.hasStableId(s)){s.addStyleClass("sapUiRtaPersAdd");i.addStyleClass("sapUiRtaMarginBottom")}else if(i.getMetadata().getName()==="sap.uxap.ObjectPageLayout"&&this.hasStableId(s)){s.addStyleClass("sapUiRtaPersAddTop");i.getDomRef().querySelectorAll("[id*='sectionsContainer']").forEach(function(e){e.classList.add("sapUiRtaPaddingTop")})}var r=function(e,t,a){var s;var i="sections";if(e){s=t.getDesignTimeMetadata().getName().plural}else{s=t.getDesignTimeMetadata().getAggregation(i).childNames.plural()}this.clearCachedElements();this.showAvailableElements(e,i,[t],a,s)}.bind(this);var n=function(e,t,s,i,n){var o=function(e){var t=a.getOverlay(e.currentTarget.id.replace("-AddButton",""));r(s,t,n);e.stopPropagation()};var l=typeof i==="function"?i():i;this._addButton(e,o,t,l,s)}.bind(this);if(s.hasStyleClass("sapUiRtaPersAdd")){var o=Array.from(s.getDomRef().querySelectorAll(":scope > .sapUiRtaPersAddIconOuter"));var l=s.hasStyleClass("sapUiRtaPersAdd")&&o.length===0;if(l){n(s,s.getDomRef(),true,s.getDesignTimeMetadata().getName().singular)}}else if(s.hasStyleClass("sapUiRtaPersAddTop")){var o=Array.from(s.getAggregationOverlay("sections").getDomRef().querySelectorAll(":scope > .sapUiRtaPersAddIconOuter"));if(o.length===0){var d=s.getAggregationOverlay("sections").getDomRef();n(s,d,false,s.getDesignTimeMetadata().getAggregation("sections").childNames.singular,0)}}t.prototype.registerElementOverlay.apply(this,e)};i.prototype.deregisterElementOverlay=function(...e){const[a]=e;var s=a.getElement();if(a._oAddButton){a._oAddButton.destroy()}if(s.getMetadata().getName()==="sap.uxap.ObjectPageSection"){a.removeStyleClass("sapUiRtaPersAdd");s.removeStyleClass("sapUiRtaMarginBottom")}else if(s.getMetadata().getName()==="sap.uxap.ObjectPageLayout"){a.removeStyleClass("sapUiRtaPersAddTop");s.getDomRef().querySelectorAll("[id*='sectionsContainer']").forEach(function(e){e.classList.remove("sapUiRtaPaddingTop")})}t.prototype.deregisterElementOverlay.apply(this,e)};i.prototype._isEditable=function(...e){const[a]=e;return t.prototype._isEditable.apply(this,e).then(function(e){if(a._oAddButton){var t=a.hasStyleClass("sapUiRtaPersAddTop");var s=t?"asChild":"asSibling";a._oAddButton.setEnabled(e[s]);if(t){var i=a.getElement();i.attachEventOnce("onAfterRenderingDOMReady",function(){i.getDomRef().querySelectorAll("[id*='sectionsContainer']").forEach(function(e){e.classList.add("sapUiRtaPaddingTop")})})}}return e})};i.prototype._addButton=function(t,i,r,n,o){var l=t.getEditableByPlugins().indexOf(this._retrievePluginName(o))>-1;var d=e.getResourceBundleFor("sap.ui.rta");var g=`${t.getId()}-AddButton`;var p=document.createElement("div");p.classList.add("sapUiRtaPersAddIconOuter");p.setAttribute("draggable","true");p.setAttribute("tabindex",-1);t._oAddButton=new s(g,{text:d.getText("CTX_ADD_ELEMENTS",[n]),icon:"sap-icon://add",enabled:l}).placeAt(p).attachBrowserEvent("click",i).attachBrowserEvent("tap",i);r.append(p);p.addEventListener("mouseover",function(e){e.stopPropagation();var t=e.fromElement?a.getOverlay(e.fromElement.id):null;if(t&&t.getMetadata().getName()==="sap.ui.dt.ElementOverlay"){var s=t.getParentElementOverlay();s.removeStyleClass("sapUiRtaOverlayHover")}});p.addEventListener("mouseleave",function(e){e.stopPropagation();var t=e.toElement?a.getOverlay(e.toElement.id):null;if(t&&t.getMetadata().getName()==="sap.ui.dt.ElementOverlay"){var s=t.getParentElementOverlay();if(s.getMovable()){s.addStyleClass("sapUiRtaOverlayHover")}}});p.addEventListener("click",function(e){e.stopPropagation()});p.addEventListener("contextmenu",function(e){e.stopPropagation();e.preventDefault()});p.addEventListener("dragstart",function(e){e.stopPropagation();e.preventDefault()})};return i});
//# sourceMappingURL=EasyAdd.js.map