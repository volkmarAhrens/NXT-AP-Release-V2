/*!
 * OpenUI5
 * (c) Copyright 2009-2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Element","sap/ui/core/Lib","sap/ui/rta/plugin/Plugin","sap/ui/dt/Util","sap/ui/fl/Utils","sap/ui/fl/apply/api/ControlVariantApplyAPI","sap/ui/fl/write/api/LocalResetAPI","sap/ui/rta/command/CompositeCommand","sap/m/MessageToast","sap/ui/dt/OverlayRegistry"],function(e,t,a,n,r,i,o,s,l,u){"use strict";function p(e,t){return t?e.getCurrentVariantReference(t):""}var d=a.extend("sap.ui.rta.plugin.LocalReset",{metadata:{library:"sap.ui.rta",properties:{},associations:{},events:{}}});d.prototype._isEditable=function(e){if(!this.hasStableId(e)){return false}var t=this.getAction(e);return!!t};d.prototype.isEnabled=function(e){if(e.length!==1){return false}var t=e[0];var a=t.getElement();var n=this.getAction(t);if(!n){return false}var s=true;if(typeof n.isEnabled!=="undefined"){if(typeof n.isEnabled==="function"){s=n.isEnabled(a)}else{s=n.isEnabled}}var l=n.changeOnRelevantContainer?t.getRelevantContainer():a;var d=u.getOverlay(l);var c=r.getAppComponentForControl(l);var g=c.getModel(i.getVariantModelName());var m=p(g,this.getVariantManagementReference(d));return s&&o.isResetEnabled(l,{layer:this.getCommandFactory().getFlexSettings().layer,currentVariant:m})};d.prototype.getMenuItems=function(e){return this._getMenuItems(e,{pluginId:"CTX_LOCAL_RESET",rank:61,icon:"sap-icon://reset"})};d.prototype.getActionName=function(){return"localReset"};d.prototype.handler=function(a){var o=a[0];var u=o.getElement();var d=o.getDesignTimeMetadata();var c=this.getVariantManagementReference(o);var g=r.getAppComponentForControl(u);var m=g.getModel(i.getVariantModelName());var f=p(m,c);var v=!!f;var h=v?g.byId(c)||e.getElementById(c):undefined;var E=this.getCommandFactory();var y=new s;return Promise.all([E.getCommandFor(u,"localReset",{currentVariant:f},d,c),v&&E.getCommandFor(h,"save",{model:m},d,c)].filter(Boolean)).then(function(e){e.forEach(function(e){y.addCommand(e)});this.fireElementModified({command:y});if(v){var a=t.getResourceBundleFor("sap.ui.rta").getText("MSG_LOCAL_RESET_VARIANT_SAVE");l.show(a,{duration:5e3})}}.bind(this)).catch(function(e){throw n.propagateError(e,"LocalReset#handler","Error occurred during handler execution","sap.ui.rta.plugin")})};return d});
//# sourceMappingURL=LocalReset.js.map